module.exports=function(t){var a={};function o(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=t,o.c=a,o.d=function(t,a,e){o.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,a){if(1&a&&(t=o(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var s in t)o.d(e,s,function(a){return t[a]}.bind(null,s));return e},o.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(a,"a",a),a},o.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},o.p="",o(o.s=23)}([function(t,a){t.exports=flarum.core.compat["helpers/icon"]},function(t,a){t.exports=flarum.core.compat.Component},function(t,a){t.exports=flarum.core.compat.extend},function(t,a){t.exports=flarum.core.compat["components/IndexPage"]},function(t,a){t.exports=flarum.core.compat["utils/ItemList"]},function(t,a){t.exports=flarum.core.compat["helpers/listItems"]},function(t,a){t.exports=flarum.core.compat["helpers/username"]},function(t,a){t.exports=flarum.core.compat["tags/utils/sortTags"]},function(t,a){t.exports=flarum.core.compat["helpers/avatar"]},function(t,a){t.exports=flarum.core.compat["helpers/humanTime"]},function(t,a){t.exports=flarum.core.compat["components/LinkButton"]},function(t,a){t.exports=flarum.core.compat["utils/humanTime"]},,function(t,a){t.exports=flarum.core.compat.Model},function(t,a){t.exports=flarum.core.compat["tags/models/Tag"]},function(t,a){t.exports=flarum.core.compat["components/Page"]},function(t,a){t.exports=flarum.core.compat["tags/helpers/tagLabel"]},function(t,a){t.exports=flarum.core.compat["tags/components/TagsPage"]},function(t,a){t.exports=flarum.core.compat["utils/string"]},function(t,a){t.exports=flarum.core.compat["utils/UserControls"]},function(t,a){t.exports=flarum.core.compat["components/Dropdown"]},function(t,a){t.exports=flarum.core.compat["components/AvatarEditor"]},,function(t,a,o){"use strict";o.r(a);var e=o(2),s=o(3),r=o.n(s),n=o(10),i=o.n(n),c=o(13),u=o.n(c),p=o(14),l=o.n(p);function f(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a}var g=o(15),d=o.n(g),h=o(5),v=o.n(h),C=o(9),y=o.n(C),b=o(7),T=o.n(b),x=o(16),w=o.n(x),k=o(17),P=o.n(k),N=o(1),D=o.n(N),_=o(0),I=o.n(_),L=o(4),A=o.n(L),S=function(t){function a(){return t.apply(this,arguments)||this}return f(a,t),a.prototype.view=function(){var t=app.forum.attribute("categories.compactMobile")&&window.innerWidth<767;return m("div",{class:"StatWidget"},m("div",{class:"StatWidget-count"},this.props.count),m("div",{class:"StatWidget-label"},t?I()(this.props.icon):this.props.label))},a}(D.a),j=o(8),M=o.n(j),U=o(6),O=o.n(U),B=o(18),R=o(11),W=o.n(R),V=o(19),E=o.n(V),z=o(20),q=o.n(z),F=o(21),G=o.n(F),H=function(t){function a(){return t.apply(this,arguments)||this}f(a,t);var o=a.prototype;return o.view=function(){var t=this.props.user,a=E.a.controls(t,this).toArray(),o=t.color(),e=t.badges().toArray();return m("div",{className:"UserCard "+(this.props.className||""),style:o?{backgroundColor:o}:""},m("div",{className:"darkenBackground"},m("div",{className:"container"},a.length?q.a.component({children:a,className:"UserCard-controls App-primaryControl",menuClassName:"Dropdown-menu--right",buttonClassName:this.props.controlsButtonClassName,label:app.translator.trans("core.forum.user_controls.button"),icon:"fas fa-ellipsis-v"}):"",m("div",{className:"UserCard-profile"},m("h2",{className:"UserCard-identity"},this.props.editable?[G.a.component({user:t,className:"UserCard-avatar"}),O()(t)]:m("a",{href:app.route.user(t),config:this.stopProp},m("div",{className:"UserCard-avatar"},M()(t)),O()(t))),e.length?m("ul",{className:"UserCard-badges badges"},v()(e)):"",m("ul",{className:"UserCard-info"},v()(this.infoItems().toArray()))))))},o.infoItems=function(){var t=new A.a,a=this.props.user,o=a.lastSeenAt();if(o){var e=a.isOnline();t.add("lastSeen",m("span",{className:"UserCard-lastSeen"+(e?" online":"")},e?[I()("fas fa-circle")," ",app.translator.trans("core.forum.user.online_text")]:[I()("far fa-clock")," ",W()(o)]))}return a.joinTime()&&t.add("joined",app.translator.trans("core.forum.user.joined_date_text",{ago:W()(a.joinTime())})),t},o.stopProp=function(t,a){a||($(t).on("click",(function(t){return t.stopPropagation()})),m.route.apply(this,arguments))},a}(D.a),J=function(t){function a(){return t.apply(this,arguments)||this}f(a,t);var o=a.prototype;return o.init=function(){this.cardVisible=!1},o.view=function(){var t=this.props.discussion;if(!t)return m("div",{class:"LastDiscussion"},app.translator.trans("askvortsov-categories.forum.last_discussion_widget.no_discussions"));var a=t.lastPostedUser(),o="";return a&&this.cardVisible&&(o=H.component({user:a,className:"UserCard--popover",controlsButtonClassName:"Button Button--icon Button--flat"})),m("a",{class:"LastDiscussion",href:app.route.discussion(t),config:this.stopProp},m("a",{className:"LastDiscussion-avatar",href:a?app.route.user(a):"#",config:this.stopProp},M()(a)),m("div",{class:"LastDiscussion-content"},m("div",{class:"LastDiscussion-bottomRow"},y()(t.lastPostedAt())," ",m("a",{className:"LastDiscussion-usernameLink",href:a?app.route.user(a):"#",config:this.stopProp}," ","| ",O()(a))),m("div",{class:"LastDiscussion-topRow"},Object(B.truncate)(t.title(),26))),m("div",{class:"LastDiscussion-userCardContainer"},o))},o.stopProp=function(t,a){a||($(t).on("click",(function(t){return t.stopPropagation()})),m.route.apply(this,arguments))},o.config=function(t){var a,o=this;t||this.$().on("mouseover",".LastDiscussion-avatar, .LastDiscussion-usernameLinkUserCard, .username, .UserCard",(function(){clearTimeout(a),a=setTimeout(o.showCard.bind(o),300)})).on("mouseout",".LastDiscussion-avatar, .LastDiscussion-usernameLinkUserCard, .username, .UserCard",(function(){clearTimeout(a),a=setTimeout(o.hideCard.bind(o),150)}))},o.showCard=function(){var t=this;this.cardVisible=!0,m.redraw(),setTimeout((function(){return t.$(".UserCard").addClass("in")}))},o.hideCard=function(){$(".UserCard").removeClass("in"),this.cardVisible=!1,m.redraw()},a}(D.a),K=function(t){function a(){return t.apply(this,arguments)||this}f(a,t);var o=a.prototype;return o.init=function(){t.prototype.init.call(this),this.tag=this.props.tag,this.isChild=null!=this.props.parent&&null!=this.props.parent,this.collapsed=!1,window.addEventListener("resize",(function(){m.redraw()}))},o.view=function(){var t=this,o=this.tag;if(!o)return"";this.compactMobileMode=window.innerWidth<=767&&app.forum.attribute("categories.compactMobile");var e=this.isChild?[]:T()(app.store.all("tags").filter((function(t){return t.parent()===o}))),s=this.isChild?{}:{backgroundColor:o.color()},r=["TagCategory","TagCategory-"+o.slug()];this.isChild?r.push("SubCategory"):r.push("ParentCategory"),this.compactMobileMode&&r.push("compactMobile");var n=(o.lastPostedDiscussion()?["TagCategory-lastDiscussion"]:["TagCategory-lastDiscussion empty"]).join(" "),i=!this.isChild&&this.compactMobileMode,c=m("ol",{className:"TagCategory-subTagList"},e.map((function(o){return[a.component({tag:o,parent:t})]})));return m("li",{class:r.join(" ")},m("a",{class:"TagCategory-content TagCategory-content-"+o.slug(),style:s,href:app.route.tag(o),config:this.stopProp},m("div",{class:"TagCategory-alignStart"},m("div",{class:"TagCategory-alignStart-main"},m("span",{class:"TagCategory-icon"},this.iconItems().toArray()),m("div",{class:"TagCategory-main"},this.mainItems().toArray())),0==e.length?"":m("p",{class:"TagCategory-toggleArrow",onclick:function(a){t.toggleArrow(a)}},I()(this.collapsed?"fas fa-caret-down":"fas fa-caret-up"))),m("div",{class:"TagCategory-alignEnd"},m("div",{class:"TagCategory-stats StatWidgetList"},this.statItems().toArray()),m("div",{class:n},this.lastDiscussionItems().toArray())),i&&!this.collapsed?c:""),i||this.isChild?"":c)},o.iconItems=function(){var t=new A.a;if(this.tag.icon()&&this.isChild){var a={},o="fa-stack-1x CategoryIcon";app.forum.attribute("categories.childBareIcon")&&(a.color=this.tag.color(),o+=" NoBackgroundCategoryIcon");var e=this.compactMobileMode?"fa-stack fa-1x":"fa-stack fa-2x";t.add("icon",m("span",{class:e},app.forum.attribute("categories.childBareIcon")?"":m("i",{class:"fa fa-circle fa-stack-2x icon-background",style:{color:this.tag.color()}}),I()(this.tag.icon(),{className:o,style:a})),10)}else if(this.tag.icon()&&!app.forum.attribute("categories.parentRemoveIcon")){var s=this.compactMobileMode?"fa-stack fa-2x":"fa-stack fa-3x";t.add("icon",m("span",{class:s},I()(this.tag.icon(),{className:"fa-stack-1x CategoryIcon"})),10)}return t},o.mainItems=function(){var t=new A.a;return t.add("name",m("h4",{class:"TagCategory-name"},this.tag.name()),15),!this.tag.description()||!this.isChild&&app.forum.attribute("categories.parentRemoveDescription")||t.add("description",m("div",{class:"TagCategory-description"},this.tag.description()),10),t},o.statItems=function(){var t=new A.a;return!this.isChild&&app.forum.attribute("categories.parentRemoveStats")||(t.add("discussionCount",S.component({count:this.tag.discussionCount(),label:app.translator.trans("askvortsov-categories.forum.stat-widgets.discussion_label"),icon:"fas fa-file-alt"}),15),t.add("postCount",S.component({count:this.tag.postCount(),label:app.translator.trans("askvortsov-categories.forum.stat-widgets.post_label"),icon:"fas fa-comment"}),10)),t},o.lastDiscussionItems=function(){var t=new A.a;return!this.isChild&&app.forum.attribute("categories.parentRemoveLastDiscussion")||t.add("lastDiscussion",J.component({discussion:this.tag.lastPostedDiscussion()}),10),t},o.config=function(t){t||(this.$(".TagCategory-content,.TagCategory-toggleArrow").bind("mouseenter",(function(t){$(this).addClass("hover"),($(this).parent().hasClass("SubCategory")||$(this).hasClass("TagCategory-toggleArrow"))&&$(this).closest(".ParentCategory").children(".TagCategory-content").removeClass("hover")})),this.$(".TagCategory-content,.TagCategory-toggleArrow").bind("mouseleave",(function(t){$(this).removeClass("hover"),($(this).parent().hasClass("SubCategory")||$(this).hasClass("TagCategory-toggleArrow"))&&$(this).closest(".ParentCategory").children(".TagCategory-content").addClass("hover")})))},o.toggleArrow=function(t){t.preventDefault(),t.stopPropagation(),this.collapsed=!this.collapsed,m.redraw()},o.stopProp=function(t,a){a||($(t).on("click",(function(t){return t.stopPropagation()})),m.route.apply(this,arguments))},a}(D.a),Q=function(t){function a(){return t.apply(this,arguments)||this}f(a,t);var o=a.prototype;return o.init=function(){d.a.prototype.init.call(this),this.tags=T()(app.store.all("tags").filter((function(t){return!t.parent()}))),app.history.push("categories",app.translator.trans("askvortsov-category.forum.header.back_to_categories_tooltip")),Object(e.extend)(r.a.prototype,"sidebarItems",(function(t){if(app.current instanceof a&&app.forum.attribute("categories.fullPageDesktop"))for(var o in t.items)"newDiscussion"!=o&&"nav"!=o&&t.remove(o);return t}))},o.view=function(){var t=this.tags.filter((function(t){return null!==t.position()})),a=this.tags.filter((function(t){return null===t.position()})),o=app.forum.attribute("categories.fullPageDesktop")?["CategoriesPage","TagsPage"]:["CategoriesPage"];return m("div",{className:o.join(" ")},r.a.prototype.hero(),m("div",{className:"container"},m("div",{className:app.forum.attribute("categories.fullPageDesktop")?"":"sideNavContainer"},m("nav",{className:"CategoriesPage-nav TagsPage-nav IndexPage-nav sideNav",config:r.a.prototype.affixSidebar},m("ul",null,v()(r.a.prototype.sidebarItems().toArray()))),m("div",{className:"CategoriesPage-content sideNavOffset"},m("ol",{className:"TagCategoryList"},t.map((function(t){return K.component({tag:t})}))),a.length?m("div",{className:"TagCloud"},a.map((function(t){return[w()(t,{link:!0})," "]}))):""))))},o.config=function(){for(var a,o=arguments.length,e=new Array(o),s=0;s<o;s++)e[s]=arguments[s];(a=t.prototype.config).call.apply(a,[this].concat(e)),"/"!=m.route()?app.setTitle(app.translator.trans("askvortsov-categories.forum.meta.categories_title")):app.setTitle(""),app.setTitleCount(0)},a}(P.a);app.initializers.add("askvortsov/flarum-categories",(function(){app.routes.categories={path:"/categories",component:Q.component()},l.a.prototype.postCount=u.a.attribute("postCount"),Object(e.extend)(r.a.prototype,"navItems",(function(t){return t.has("tags")&&!app.forum.attribute("categories.keepTagsNav")&&t.remove("tags"),t.add("categories",i.a.component({icon:"fas fa-th-list",children:app.translator.trans("askvortsov-categories.forum.index.categories_link"),href:app.route("categories")}),-9.5),t.has("moreTags")&&t.replace("moreTags",i.a.component({children:app.translator.trans("flarum-tags.forum.index.more_link"),href:app.route("categories")})),t}))}))}]);
//# sourceMappingURL=forum.js.map